---
title: "지역별 GRDP 변화 데이터를 활용한 분석과제"
date: 2019-06-23 08:26:28 -0400
categories: Assignment
tags: 분석과제 R Python
permalink:/Assignment
---

주어진 데이터 중 우리나라 행정구역 시도별 지역내 총생산에 대한 지출 변화 추이에 흥미를 가져 본 데이터로 분석을 진행하기로 했다.

이는 시계열 자료이므로  21년 간의 변화 추이를 볼 수 있다는 점을 활용하여, 주어진 자료에서 특정 기간에 눈에 띄는 변화가 일어난 이벤트를 찾아 주제로 잡아 분석하고자 한다.

우선, 주어진 자료를 엑셀에서 전처리 하였다.

이 과정에선 R studio에서의 분석이 용이하도록 행렬 변환을 하고, 괄호가 들어간 긴 이름을 바꾸었다.

![title](/img/flu/noname01.png)

그리고 위의 표를 이용하여, 지역별 지역내 총생산에 대한 지출(GRDP)을 파악하기 위해 다음과 같은 그래프를 그렸다.

![title](/img/flu/noname02.png)

하지만 여기에선 서울특별시와 경기도가 압도적으로 높기에 다른 지역들의 추세를 제대로 확인하기 힘들다.

여기에서 알 수 있는건 전체적으로 GRDP가 상승하고 있다는것 뿐이다.

그러므로 같은 데이터를 이용하여 서울특별시와 경기도를 제거해서 새로운 그래프를 그려보았다.

![title](/img/flu/noname03.png)

그 결과 2009년에 GRDP가 하락하거나 성장률이 낮아보이는 것을 발견할 수 있었다.

하지만 지역별로 GRDP 규모가 크게 다르기 때문에, 한눈에 지역별 GRDP 상승과 하락의 굴곡을 보기에는 불편함이 있다.

규모보다는 상승과 하락에 초점을 맞추었으므로, R studio에서 이를 표준화하여 다시 시각화해봤다.

![title](/img/flu/noname04.png)

아래는 위치를 보기 쉽도록 위 꺾은선그래프에서 산점도를 추가한 것이다.

![title](/img/flu/noname05.png)

<pre><code>library(readxl)
library(dplyr)
library(ggplot2)
#엑셀로 한 번 전처리하여 불러옴
data<-read_excel("c:/firstdata.xlsx")
View(data)
#각 지역을 정규화
data$서울특별시<-scale(data$서울특별시)#정규화
data$부산광역시<-scale(data$부산광역시)#정규화
data$대구광역시<-scale(data$대구광역시)#정규화
data$인천광역시<-scale(data$인천광역시)#정규화
data$광주광역시<-scale(data$광주광역시)#정규화
data$대전광역시<-scale(data$대전광역시)#정규화
data$울산광역시<-scale(data$울산광역시)#정규화
data$경기도<-scale(data$경기도)#정규화
data$강원도<-scale(data$강원도)#정규화
data$충청북도<-scale(data$충청북도)#정규화
data$충청남도<-scale(data$충청남도)#정규화
data$전라북도<-scale(data$전라북도)#정규화
data$전라남도<-scale(data$전라남도)#정규화
data$경상북도<-scale(data$경상북도)#정규화
data$경상남도<-scale(data$경상남도)#정규화
data$제주특별자치도<-scale(data$제주특별자치도)#정규화
View(data)
data<-data.frame(data)
#한 번에 그래프 그리기
#그래프 그리기 위해 변형
data1<-melt(data,id.vars="year",measure.vars=c("서울특별시",
            "부산광역시","대구광역시","인천광역시",
            "광주광역시","대전광역시","울산광역시","경기도",
            "강원도","충청북도","충청남도","전라북도",
            "전라남도","경상북도","경상남도","제주특별자치도"))
View(data1)
#데이터 타입 확인
str(data1)
#year의 데이터 타입이 chr이어서 num으로 변환하여 오류 방지
data1$year<-as.numeric(data1$year)
#그래프 그리기
ggplot(data1,aes(year,value))+
  geom_line(aes(color=variable))+
  geom_point(aes(color=variable))
View(data1)</code></pre>

우리는 그래프에서 2009년에 유독 하락이 눈에 띄는 것을 볼 수 있다.

이 그래프를 해석해보면 2009년도 부산/대구가 유례 없는 큰 하락, 인천/울산이 하락, 서울/광주/대전/경기/강원/충북/충남/전북/전남/경남/제주는 약한 상승을 보였다.

10년 후엔 결과적으로 경상남도의 증가율이 가장 낮았다.

여기에서 전례없는 하락의 원인을 유추해보기로 했다.

GRDP에 영향을 줄 만한, 2009년에 일어났던 큰 사건들을 찾아보았다.

* 09년도 7월 7일 부산의 일 강수량 310mm 찍었던 당시 기상관측 사상 2위였던 호우의 영향을 생각해 볼 수 있다. 거기에 7월 16일 또다시 부산과 경남에 266mm의 강수가 이어져 해당 지역이 큰 피해를 보았다.
* 신종플루는 전국에 70만 여 명의 감염자가 발생했던 역사적인 사건이다.

우선 주어지지 않은 신종플루에 관한 통계자료를 얻기 위해 질병관리본부 감염병 포털(http://www.cdc.go.kr)에서 관련 연도의 질병별통계를 찾아보았다. 만일 다른 연도와 크게 감염자 수에 차이가 없다면 신종플루의 영향은 미미했을 것이라고 판단할 수 있다.

하지만 법정감염병(전수보고) 발생현황을 통해 신종플루가 발병했던 2009년에 환자 수가 78만여 명으로 압도적인 수치를 보였다.

이는 충분히 경제 활동에 타격을 줄 수 있는 수치라고 생각할 수 있다. 

![title](/img/flu/noname06.png)

위와 같은 그래프에 신종플루의 영향이 유의하게 있는지 확인하기 위해 지역별로 신종플루 감염자의 비율과 GRDP에 관계를 분석해보기로 했다.

하지만 감염병 포털에서는 지역별로 자세한 통계가 나타나 있지 않아 여러 자료를 찾아보았다.

먼저, 신종 인플루엔자 대유행의 경제적 영향(이를 뒷받침하는 자세한 분석 내용은 조경엽(2009) 참조 바람)
에 따르면, 감염으로 인한 노동중단, 감염으로 인한 사망, 감염위험 최소화를 위한 노동중단으로 인해 노동공급의 감소가 생산 감소로 이어지고, 이는 GDP 감소로 이어질 것으로 예상할 수 있다.

하지만 본 논문에서는 국가 규모로 분석을 수행했으며, 국내 지역별 감염에 대한 현황은 없었다.

따라서 지역별 신종플루 발병율을 비교하여 지역별 GRDP에 관계가 있는지는 새로이 찾아봐야 한다.

통계청에서 지역별 감염병 발생자 수에 대한 통계를 찾을 수 있었는데, 지역별로 4군 질병 중에서도 신종플루에 해당하는 신종감염병 자료를 엑셀로 전처리하였다.

전후 비교를 위하여 1년치씩, 즉 2008년&2009년&2010년의 데이터를 추출했다.

(여기서 세종시 출범은 2012년이므로 당시 행정구역은 충청남도로 취급했다.)

추출 후의 데이터는 왼쪽 표와 같다.

여기에서 2009년의 발병자 수가 압도적인 비율이므로 2009년도의 데이터만으로 분석하기로 했다.

따라서 오른쪽과 같은 표로 다시 전처리하여 새로 그래프를 그려보았다.

* 전

![title](/img/flu/noname07.png)

*후

![title](/img/flu/noname08.png)

*그래프

![title](/img/flu/noname09.png)

위 막대그래프에서 시도별은 지역 확인이 어려운 기타를 가리키고, 계열 1은 감염자수이다.

인구 수가 많은 서울과 경기가 높은 수로, 지역별 감염자 수는 한눈에 보이지만 감염자 비율의 파악이 어렵다. 따라서 위 데이터와 2010년 각 지역별 인구 수 데이터를 이용하여 감염자 비율을 파악하도록 한다.

공공데이터포털(https://www.data.go.kr)에서 2009년 주민등록인구 및 세대현황 데이터를 내려받았다.

![title](/img/flu/noname10.png)

R studio로 데이터 작업을 하기 위해 아래와 같이 전처리하였다.

![title](/img/flu/noname11.png)

앞에서 정리했던 감염자수 데이터와 위의 총인구수 데이터를 이용하여 지역별 신종플루 감염자수 그래프를 그렸다.

![title](/img/flu/noname12.png)

<pre><code>library(readxl)
library(dplyr)
library(ggplot2)
patientnum<-read_excel("C:/지역별감염자수.xlsx")
View(patientnum)
peoplenum<-read_excel("C:/인구수.xlsx")
View(peoplenum)
finaldata<-left_join(peoplenum,patientnum,by="시도별") #데이터결합
View(finaldata)
str(finaldata)
finaldata$감염자비율<-finaldata$감염자수/finaldata$총인구수 #비율계산
ggplot(finaldata,aes(x=시도별,y=감염자비율))+geom_col()
View(finaldata)</code></pre>

지역별로 GRDP 변화에 감염자 비율이 영향을 미쳤는지 알기 용이하도록 내림차순 정렬하여 새로 그래프를 그린다.

![title](/img/flu/noname13.png)

<pre><code>ggplot(finaldata,aes(x=reorder(시도별,-감염자비율),y=감염자비율))+geom_col()</code></pre>

우리는 제일 앞의 분석을 통해 2009년도 부산/대구가 유례 없는 큰 하락, 인천/울산이 하락, 서울/광주/대전/경기/강원/충북/충남/전북/전남/경남/제주는 약한 상승을 보였음을 보았다.

신종플루 감염자 수와 지역별 GRDP 등락의 관계성을 더 확실히 알기 위해 이 데이터로도 새로 막대그래프를 그렸다.

데이터들이 표준화되어있는 상태이므로 규모와 상관없이 (2009년의 데이터)-(2008년의 데이터)의 값이 클수록 크게 하락한 것이다.

즉, 지역별 하락의 정도를 그래프로 나타내어 순위를 매겨보면 위 그래프와 비교하여 비슷할 경우, 신종플루가 GRDP에 영향을 주는 요인이라고 할 수 있다.

![title](/img/flu/noname14.png)

<pre><code>data2008<-data1 %>% subset(data1$year=='2008')
View(data2008)
data2009<-data1 %>% subset(data1$year=='2009')
View(data2009)
data2009$diff<-data2009$value-data2008$value
View(data2009)
ggplot(data2009,aes(x=reorder(variable,diff),y=diff))+geom_col()</code></pre>

여기서 diff가 0보다 작을수록 전 해와 비교했을 때 GRDP가 하락한 것이고, 0보다 클수록 상승한 것이다.

가장 GRDP의 하락이 많은 지역 순으로 시각화하면 ‘부산 > 대구 > 인천 > 울산 > 경북 > 전남 > 광주 > 강원 > 경기 > 서울 > 전라 > 충남 > 대전 > 충북 > 경남 > 제주’ 순이며, 10쪽의 데이터에서 신종플루 감염자비율이 높은 순서는 ‘울산 > 강원 > 부산 > 인천 > 경남 > 경기 > 광주 > 충북 > 서울 > 대구 > 대전 > 전북 > 전남 > 경북 > 충남 > 제주’이다.

신종플루 감염자비율은 제주특별자치도를 제외하면 모든 지역이 기본 10%대인 비슷한 수치이므로, 감염자 비율이 극단적인 지역이 아니라면 GRDP에 영향을 주는 요인은 순서에 큰 영향을 미치지 않을 것이라고 판단하였다.

따라서 감염자비율이 20%를 상회하는 ‘울산, 강원, 부산, 인천’과 10% 이하인 ‘제주’ 지역만 보도록 한다.

감염자 비율이 높은 지역인 울산, 부산, 인천은 모두 GRDP 하락의 정도가 컸고, 감염자 비율이 가장 낮은 지역인 제주는 GRDP 상승이 가장 컸다.

예외적으로, 강원도는 감염자 비율이 높았음에도 GRDP가 약하게 상승했다.

이는 농경 비율이 높은 강원도 지역의 산업구조 특성상, 감염율이 높아도 노동중단으로 인한 경제적 손실이 크지 않았기 때문이라 예상된다.

1998년부터 2017년까지의 행정구역 시도별 지역내총생산에 대한 지출(GRDP) 데이터를 시각화한 그래프에서 2009년도에 눈에띄는 하락세를 발견했고, 이 원인이 신종플루일 것이라 예상하여 지역별 신종플루 발병자수와 지역별 인구수를 이용해 지역별 신종플루 감염자비율을 계산하여 지역별로 감염자비율이 많은 순서대로 정렬한 그래프를 만들었다.

GRDP 데이터 또한 2009년과 2008년도의 표준화시킨 GRDP의 차를 지역별로 GRDP 성장률이 낮은 순으로 정렬하여 그래프화하였고, 앞서 만든 그래프와 지역별 연관성을 비교하였다.

그 결과, 강원도는 지역의 특성을 감안했을 때, 감염자 비율이 높은 울산, 부산, 인천과 감염자 비율이 낮은 제주의 경우에서 신종플루가 2009년 지역별 GRDP에 영향을 주었음을 예상할 수 있다.

더 전문적인 분석은 국내 신종플루 확산 양상 분석(국내 신종인플루엔자 초기 단계에서의 확산 양상 분석에 대해 더 자세히 알고 싶다면 한국교육학술정보원(2014)을 참조 바람)과 지역별 산업구조 데이터 등을 활용하여 보완할 수 있을 것으로 보인다.

------------------------------

사실 자료를 보고 스스로 그래프를 여러 개 그려보는 것이 목적이었기에 분석 자체의 논리는 굉장히 허술하다.

일반화와 얕은 수준의 분석이 난무하여 민망하지만, 미래에 전문가가 된 내가 보고 멋지게 보완해낼 수 있기를 바라며 흔적을 남겨놓는다.
